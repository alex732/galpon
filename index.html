<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Capell√°n Cloud | Dashboard</title>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; text-align: center; }
        .cam-box { width: 600px; height: 350px; background: #000; margin: 20px auto; border: 3px solid #3b82f6; border-radius: 15px; position: relative; overflow: hidden; }
        #video-stream { width: 100%; height: 100%; object-fit: contain; display: none; }
        .btn { background: #22c55e; color: white; border: none; padding: 15px; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .status-box { margin-top: 10px; color: #94a3b8; font-size: 0.9rem; }
    </style>
</head>
<body>
    <h1>CAPELL√ÅN CLOUD üö¶</h1>
    <button class="btn" onclick="iniciarConexion()">CONECTAR VIDEO</button>
    
    <div class="cam-box">
        <img id="video-stream" src="">
        <div id="msg" style="margin-top:150px">C√°mara Offline</div>
    </div>
    <div id="debug" class="status-box">Estado: Esperando...</div>

    <script>
        const PROXY = "http://192.168.2.208:8080/stream-galpon";

        function iniciarConexion() {
            const img = document.getElementById("video-stream");
            const debug = document.getElementById("debug");
            const msg = document.getElementById("msg");

            debug.innerText = "Estado: Intentando conectar a " + PROXY;

            // Intentamos una petici√≥n de prueba
            fetch(PROXY, { mode: 'cors' })
                .then(res => {
                    if(res.ok) {
                        debug.innerText = "Estado: ¬°Conexi√≥n exitosa!";
                        img.style.display = "block";
                        msg.style.display = "none";
                        setInterval(() => {
                            img.src = PROXY + "?t=" + Date.now();
                        }, 1000);
                    }
                })
                .catch(err => {
                    debug.innerHTML = "BLOQUEO DE CHROME DETECTADO.<br>Por favor, abre <a href='"+PROXY+"' target='_blank' style='color:#3b82f6'>ESTE LINK</a> y dale a 'Aceptar/Continuar' si sale aviso de seguridad. Luego vuelve aqu√≠.";
                });
        }
    </script>
</body>
</html>
