<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZENTINEL MONITOR v258 | REMOTE</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        body { background: #0b0f19; color: #f8fafc; font-family: sans-serif; margin: 0; padding: 0; overflow-x: hidden; }
        .header { background: #020617; border-bottom: 2px solid #1e293b; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; }
        .brand { font-size: 18px; font-weight: 900; color: #38bdf8; letter-spacing: 1px; }
        .datetime { font-family: monospace; color: #94a3b8; font-size: 13px; }
        
        .layout { display: grid; grid-template-columns: 180px 1fr 300px; gap: 10px; padding: 10px; }
        .col { display: flex; flex-direction: column; gap: 10px; }
        
        /* CARDS */
        .card { background: #111827; border: 1px solid #1e293b; border-radius: 4px; padding: 10px; position: relative; }
        .card-h { font-size: 10px; color: #38bdf8; font-weight: 800; border-bottom: 1px solid #1e293b; margin-bottom: 10px; padding-bottom: 3px; text-transform: uppercase; }
        
        /* GAUGES (Diseño v258) */
        .gauge-box { background: #020617; border-radius: 50%; width: 85px; height: 85px; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 0 auto 10px; border: 3px solid #22c55e; box-shadow: 0 0 10px rgba(34, 197, 94, 0.1); }
        .v-val { font-size: 18px; font-weight: bold; color: #f8fafc; }
        .v-lbl { font-size: 8px; color: #94a3b8; margin-top: 2px; }
        
        /* BANNER IA */
        .banner { background: #064e3b; color: #4ade80; padding: 8px; border-radius: 4px; text-align: center; font-weight: bold; font-size: 12px; margin-bottom: 10px; border: 1px solid #10b981; }
        .banner-danger { background: #450a0a; color: #f87171; border-color: #ef4444; }

        /* VIDEO & MATRIX */
        .v-main { width: 100%; height: 350px; background: #000; border: 1px solid #1e293b; border-radius: 4px; display: flex; align-items: center; justify-content: center; color: #1e293b; }
        .matrix { display: grid; grid-template-columns: repeat(6, 1fr); gap: 2px; margin-top: 10px; }
        .cell { height: 40px; background: #000; border: 1px solid #1e293b; position: relative; border-radius: 2px; }
        .cell-tag { position: absolute; bottom: 0; width: 100%; font-size: 6px; background: rgba(0,0,0,0.7); text-align: center; }

        /* LOGS & TERMINAL */
        .terminal-box { height: 140px; background: #020617; border: 1px solid #1e293b; border-radius: 4px; margin-top: 5px; padding: 8px; font-family: monospace; font-size: 11px; overflow-y: auto; color: #38bdf8; display: flex; flex-direction: column-reverse; }
        .verbose { height: 110px; background: #000; border: 1px solid #1e293b; padding: 5px; font-family: monospace; font-size: 10px; color: #4ade80; overflow-y: auto; }
        .ia-log { height: 130px; font-size: 10px; color: #f87171; overflow-y: auto; font-family: monospace; }

        /* SISTEMA GRID */
        .sys-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 5px; }
        .sys-item { background: #020617; border: 1px solid #1e293b; padding: 5px; text-align: center; font-size: 9px; border-radius: 2px; }
        .sys-val { display: block; color: #38bdf8; font-weight: bold; font-size: 11px; }

        #rain-ico { font-size: 30px; margin: 10px auto; display: block; text-align: center; }
    </style>
</head>
<body>

<div class="header">
    <div class="brand">ZENTINEL MONITOR v258</div>
    <div class="datetime" id="topDate">--/--/-- --:--:--</div>
</div>

<div class="layout">
    <div class="col">
        <div class="card">
            <div class="card-h">Sensores</div>
            <div class="gauge-box" id="bgT"><span id="vT" class="v-val">--</span><span class="v-lbl">TEMP</span></div>
            <div class="gauge-box" id="bgH"><span id="vH" class="v-val">--</span><span class="v-lbl">HUM</span></div>
            <div class="gauge-box" id="bgN"><span id="vN" class="v-val">--</span><span class="v-lbl">NH3</span></div>
            <div class="card" style="padding: 5px; margin:0;"><span id="rain-ico">☀️</span></div>
        </div>
        <div class="card">
            <div class="card-h">Satélite NOAA</div>
            <img src="https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/car/GEOCOLOR/latest.jpg" style="width:100%; border-radius:2px;">
        </div>
        <div class="card">
            <div class="card-h">IA Clima</div>
            <div id="w-pred" style="font-size: 9px; color: #94a3b8; font-family: monospace;">Analizando...</div>
        </div>
    </div>

    <div class="col">
        <div id="ia-banner" class="banner">MONITOREO REMOTO ACTIVO</div>
        <div class="v-main">[VIDEO EN VIVO SOLO RED LOCAL]</div>
        <div id="matrix" class="matrix"></div>
        <div class="card">
            <div class="card-h">Terminal</div>
            <div id="chat" class="terminal-box"></div>
        </div>
    </div>

    <div class="col">
        <div class="card">
            <div class="card-h">Sistema & Red</div>
            <div class="sys-grid">
                <div class="sys-item"><span id="cpu" class="sys-val">--</span>CPU</div>
                <div class="sys-item"><span id="ram" class="sys-val">--</span>RAM</div>
                <div class="sys-item"><span id="dsk" class="sys-val">--</span>DSK</div>
            </div>
            <div class="sys-grid" style="margin-top:5px;">
                <div class="sys-item">IA: <span id="s-ia">--</span></div>
                <div class="sys-item">ARD: <span id="s-ard">--</span></div>
                <div class="sys-item">MOT: <span id="s-mot">--</span></div>
            </div>
        </div>
        <div class="card">
            <div class="card-h">Verbose Log</div>
            <div id="v-log" class="verbose"></div>
        </div>
        <div class="card">
            <div class="card-h">Alertas IA</div>
            <div id="ia-log" class="ia-log"></div>
        </div>
        <div class="card">
            <div class="card-h">Radar DO</div>
            <iframe style="width:100%; height:120px; border:0;" src="https://radar-met2.sna.gob.do/"></iframe>
        </div>
        <div class="card">
            <div class="card-h">Windy PP</div>
            <iframe style="width:100%; height:120px; border:0;" src="https://embed.windy.com/embed2.html?lat=19.7253&lon=-70.7397&zoom=11"></iframe>
        </div>
    </div>
</div>

<script>
    // CONFIG FIREBASE
    const firebaseConfig = { databaseURL: "https://zentinel-ai-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database().ref('status');

    // Init Matrix
    const m = document.getElementById('matrix');
    for(let i=0; i<24; i++) { m.innerHTML += `<div class="cell"><div class="cell-tag">Z${i}</div></div>`; }

    // Sync Real-Time
    db.on('value', (s) => {
        const d = s.val(); if(!d) return;
        
        document.getElementById('topDate').innerText = d.lastUpdate || "";
        document.getElementById('vT').innerText = d.temp + "°";
        document.getElementById('vH').innerText = d.hum + "%";
        document.getElementById('vN').innerText = d.nh3;
        document.getElementById('rain-ico').innerText = d.rain === "SI" ? "⛈️" : "☀️";
        
        document.getElementById('cpu').innerText = d.cpu || "--";
        document.getElementById('ram').innerText = d.ram || "--";
        document.getElementById('dsk').innerText = d.disk || "--";
        
        document.getElementById('s-ia').innerText = "ON";
        document.getElementById('s-ard').innerText = "ON";
        document.getElementById('s-mot').innerText = d.motor || "IDLE";
        
        document.getElementById('w-pred').innerText = d.weather || "Estable";
        
        const banner = document.getElementById('ia-banner');
        if(d.iaAlert && d.iaAlert !== "OK") {
            banner.innerText = d.iaAlert;
            banner.className = "banner banner-danger";
            document.getElementById('ia-log').innerHTML = `<div>[${d.lastUpdate}] ${d.iaAlert}</div>` + document.getElementById('ia-log').innerHTML;
        } else {
            banner.innerText = "MONITOREO REMOTO NORMAL";
            banner.className = "banner";
        }
    });
</script>
</body>
</html>
